---
title: "MLTransform"
---
<!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

{{< localstorage language language-py >}}


<table>
  <tr>
    <td>
      <a>
      {{< button-pydoc path="apache_beam.ml.transforms" class="MLTransform" >}}
      </a>
   </td>
  </tr>
</table>

# MLTransform for data processing

`MLTransform` is used to apply common machine learning processing tasks on keyed data. Apache Beam provides ML data processing transformations which can be used with `MLTransform`. You can find the full list of available data
processing transformations in the GitHub repository or the API docs.

<!-- pending links -->

To define a data processing transformation using `MLTransform`, you need to create instances of data processing transforms with `columns` as input paramter. The data in the specified `columns` will be transformed and outputted in the `beam.Row` object.

Let's look at an example

```
scale_to_z_score_transform = ScaleToZScore(columns=['x', 'y'])
with beam.Pipeline() as p:
  (data | MLTransform(artifact_location).with_transform(scale_to_z_score_transform))
```

In this example, `MLTransform` receives `artifact_location`. This location is used to store artifacts generated by the `MLTransform`. We will talk about the `artifacts` later. The data processing transform can be passed using the `with_transform` method of `MLTransform` or transforms can be passed as list to the MLTransform.

```
MLTransform(transforms=transforms, artifact_location=artifact_location)
```

All the transforms passed to `MLTransform` are applied sequentially on the dataset. `MLTransform` expects a keyed data (Link to the supported inputs).


## Example 1

In the example we will create a pipeline that uses MLTransform to scale the data between 0 and 1.

{{< highlight language="py" file="sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py"
  class="notebook-skip" >}}
{{< code_sample "sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py" mltransform_scale_to_0_1 >}}
{{</ highlight >}}

{{< paragraph class="notebook-skip" >}}
Output:
{{< /paragraph >}}

{{< highlight class="notebook-skip" >}}
{{< code_sample "sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py" mltransform_scale_to_0_1 >}}
{{< /highlight >}}

The example takes a list of ints and converts them into the range of 0 to 1 using the transform `ScaleTo01`.

## Example 2

In the example, we will create a pipeline that use MLTransform to compute vocabulary on the entire dataset and assign indices to each unique vocab.

{{< highlight language="py" file="sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py"
  class="notebook-skip" >}}
{{< code_sample "sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py" ml_transform_compute_and_apply_vocabulary >}}
{{</ highlight >}}

{{< paragraph class="notebook-skip" >}}
Output:
{{< /paragraph >}}

{{< highlight class="notebook-skip" >}}
{{< code_sample "sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py" ml_transform_compute_and_apply_vocabulary >}}
{{< /highlight >}}

This example takes a list of strings, computes vocab over the entire dataset and applies a unique index to each vocab.


The above two examples requires a full pass over the dataset to transform the dataset. For `ComputeAndApplyVocabulary`, all the unqiue words in the dataset needs to be known before transforming the data. For `ScaleTo01`, the minimum and maximum of the dataset needs to be known before transforming the dataset. This is acheived by `MLTransform`.

You can also apply MLTransform on primitive type dataset.

For example,

{{< highlight language="py" file="sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py"
  class="notebook-skip" >}}
{{< code_sample "sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py" ml_transform_compute_and_apply_vocabulary_with_non_columnar_data >}}
{{</ highlight >}}

{{< paragraph class="notebook-skip" >}}
Output:
{{< /paragraph >}}

{{< highlight class="notebook-skip" >}}
{{< code_sample "sdks/python/apache_beam/examples/snippets/transforms/elementwise/mltransform.py" ml_transform_compute_and_apply_vocabulary_with_non_columnar_data >}}
{{< /highlight >}}